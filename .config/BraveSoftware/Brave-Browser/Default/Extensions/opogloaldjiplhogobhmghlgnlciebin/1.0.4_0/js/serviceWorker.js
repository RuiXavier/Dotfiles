var I=(t=>(t.InspectFullPage="InspectFullPage",t))(I||{});const c=chrome,x=()=>new Promise(((t,e)=>{c.tabs.query({active:!0,currentWindow:!0},(r=>{c.runtime.lastError?e(c.runtime.lastError):t(r[0])}))})),P=(t,e)=>new Promise(((r,n)=>{c.scripting.executeScript({target:{tabId:t},func:e},(e=>{var o;c.runtime.lastError?n(c.runtime.lastError):r({...(null==(o=e[0])?void 0:o.result)??{},tabId:t})}))})),A=()=>{var t;const e={title:document.title,url:window.location.href,iconUrl:(null==(t=document.querySelector("link[rel~='icon']"))?void 0:t.href)||""},r=Array.from(document.querySelectorAll("*")),n=Array.from(new Set(r.flatMap((t=>getComputedStyle(t).fontFamily.split(","))).map((t=>t.trim().replace(/^['"]|['"]$/g,""))))),o=Array.from(new Set(r.map((t=>(t=>{const e=getComputedStyle(t).fontFamily,r=document.createElement("canvas").getContext("2d");if(r){const t="abcdefghijklmnopqrstuvwxyz0123456789",n=e=>(r.font=`100px ${e}`,r.measureText(t).width),o=n(e.split(",")[0].trim());for(const t of e.split(",")){const e=t.trim().replace(/^['"]|['"]$/g,"");if(n(e)===o)return e}}return e.split(",")[0].trim()})(t))))),a=r.reduce(((t,e)=>{const r=getComputedStyle(e).backgroundColor;if(r){const e=(t=>{const e=t.match(/\d+/g);if(e)return`#${(16777216+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1).toUpperCase()}`;return t})(r);"#ffffff"!==e.toLowerCase()&&(t[e]=(t[e]||0)+1)}return t}),{});return{pageInfo:e,fontFamilies:n,usedFonts:o,colors:Object.entries(a).sort(((t,e)=>e[1]-t[1])).slice(0,6).map((([t])=>t))}},v=()=>new Promise(((t,e)=>{c.tabs.query({active:!0,currentWindow:!0},(r=>{c.runtime.lastError?e(c.runtime.lastError):t(r[0])}))})).then((t=>t&&t.id?P(t.id,A):{pageInfo:{title:"No active tab found",url:"",iconUrl:""},fontFamilies:[],usedFonts:[],colors:[],tabId:t.id})).catch((t=>({pageInfo:{title:"No title found",url:"",iconUrl:""},fontFamilies:[],usedFonts:[],colors:[],tabId:0}))),F={sendMessage:async function(t,e){await chrome.tabs.sendMessage(t,e)}};var f=(t=>(t.InspectFullPage="InspectFullPage",t.StartInspector="StartInspector",t))(f||{});const M=async()=>{new Promise(((t,e)=>{c.tabs.query({active:!0,currentWindow:!0},(r=>{c.runtime.lastError?e(c.runtime.lastError):t(r[0])}))})).then((t=>t&&t.id?P(t.id,A):{pageInfo:{title:"No active tab found",url:"",iconUrl:""},fontFamilies:[],usedFonts:[],colors:[],tabId:t.id})).catch((t=>({pageInfo:{title:"No title found",url:"",iconUrl:""},fontFamilies:[],usedFonts:[],colors:[],tabId:0}))).then((t=>{F.sendMessage(t.tabId,{action:f.InspectFullPage,data:t})}))},k=async({action:t},e)=>{switch(t){case I.InspectFullPage:await M()}return!0},q=t=>{F.sendMessage(t.id,{action:f.StartInspector})};chrome.runtime.onMessage.addListener(k),chrome.action.onClicked.addListener(q);